## Survival model
sigmoid = function(x, a, b, c) a/(1+exp(-(x - b)*c))
## Visualisation
par(mfrow=c(3,1), bty='l')
plot(B, D, type='b')
plot(B, D * rho, type='b')
plot(B, s, type='b')
b = seq(0,max(B),0.1)
lines(b, sigmoid(b, 0.988, -75.0, 0.025), col='blue') # Without Canker disease
lines(b, sigmoid(b, 0.988, 20.0, 0.05), col='red') # With Canker disease
par(mfrow=c(1,1))
#
###
## Visualise
x = seq(0, 10, .1)
plot(data$age, data$total.weight/data$density * 1.2, xlim=c(0,10), ylim=c(0,1), xlab='Age (years)', ylab='Total Biomass (kg/tree)')
lines(x, exp(age_to_biomass(x)), col="red")
####################################
## ONTOGENY - DIAMETER TO BIOMASS ##
####################################
## Diameter to biomass (Bella et al. 1980)
diameter_to_biomass = function(D, a, b, rho) exp(a + b * log(D^3 * rho)) * 1.2 # With scaling by 1.2 for below ground biomass
a = -0.80319; b = 0.936736; rho = 103.7795
#
###
#########################
## SURVIVAL ~ ANALYSIS ##
#########################
## Mortalities and diameter at breast height (Zegler et al. 2012)
m = c(0.16, 0.7, 0.8, 0.5, 1/83) # last point is asymptotic survival
s = 1 - m
D = c(1.0, 2.5, 5.0, 10.0, 2774/103.7795) # last point is asymptotic diameter
## Converting to biomass
B = diameter_to_biomass(D,a,b,rho)/1000
## Survival model
sigmoid = function(x, a, b, c) a/(1+exp(-(x - b)*c))
## Visualisation
par(mfrow=c(3,1), bty='l')
plot(B, D, type='b')
plot(B, D * rho, type='b')
plot(B, s, type='b')
b = seq(0,max(B),0.1)
lines(b, sigmoid(b, 0.988, -75.0, 0.025), col='blue') # Without Canker disease
lines(b, sigmoid(b, 0.988, 20.0, 0.05), col='red') # With Canker disease
par(mfrow=c(1,1))
plot(B, s, type='b', xlab='Biomass (kg/tree)', ylab='Survival Probability')
## Mortalities and diameter at breast height (Zegler et al. 2012)
m = c(0.16, 0.7, 0.8, 0.5, 1/83) # last point is asymptotic survival
s = 1 - m
D = c(1.0, 2.5, 5.0, 10.0, 2774/103.7795) # last point is asymptotic diameter
## Converting to biomass
B = diameter_to_biomass(D,a,b,rho)/1000
## Survival model
sigmoid = function(x, a, b, c) a/(1+exp(-(x - b)*c))
## Visualisation
par(mfrow=c(3,1), bty='l')
plot(B, D, type='b', xlab='Biomass (kg/tree)', ylab='Diameter (cm)')
## Mortalities and diameter at breast height (Zegler et al. 2012)
m = c(0.16, 0.7, 0.8, 0.5, 1/83) # last point is asymptotic survival
s = 1 - m
D = c(1.0, 2.5, 5.0, 10.0, 2774/103.7795) # last point is asymptotic diameter
## Converting to biomass
B = diameter_to_biomass(D,a,b,rho)/1000
## Survival model
sigmoid = function(x, a, b, c) a/(1+exp(-(x - b)*c))
## Visualisation
par(mfrow=c(3,1), bty='l')
plot(B, D, type='b', xlab='Biomass (kg/tree)', ylab='Diameter (cm)')
## Diameter to biomass (Bella et al. 1980)
diameter_to_biomass = function(D, a, b, rho) exp(a + b * log(D^3 * rho)) * 1.2 # With scaling by 1.2 for below ground biomass
a = -0.80319; b = 0.936736; rho = 103.7795
#
###
#########################
## SURVIVAL ~ ANALYSIS ##
#########################
## Mortalities and diameter at breast height (Zegler et al. 2012)
m = c(0.16, 0.7, 0.8, 0.5, 1/83) # last point is asymptotic survival
s = 1 - m
D = c(1.0, 2.5, 5.0, 10.0, 2774/103.7795) # last point is asymptotic diameter
## Converting to biomass
B = diameter_to_biomass(D,a,b,rho)/1000
## Survival model
sigmoid = function(x, a, b, c) a/(1+exp(-(x - b)*c))
## Visualisation
par(mfrow=c(3,1), bty='l')
plot(B, D, type='b', xlab='Biomass (kg/tree)', ylab='Diameter (cm)')
plot(B, D * rho, type='b', xlab='Biomass (kg/tree)', ylab='Height (cm)')
plot(B, s, type='b', xlab='Biomass (kg/tree)', ylab='Survival Probability')
b = seq(0,max(B),0.1)
lines(b, sigmoid(b, 0.988, -75.0, 0.025), col='blue') # Without Canker disease
lines(b, sigmoid(b, 0.988, 20.0, 0.05), col='red') # With Canker disease
par(mfrow=c(1,1))
####################################
## ONTOGENY - DIAMETER TO BIOMASS ##
####################################
## Diameter to biomass (Bella et al. 1980)
diameter_to_biomass = function(D, a, b, rho) exp(a + b * log(D^3 * rho)) * 1.2 # With scaling by 1.2 for below ground biomass
a = -0.80319; b = 0.936736; rho = 103.7795
#
###
#########################
## SURVIVAL ~ ANALYSIS ##
#########################
## Mortalities and diameter at breast height (Zegler et al. 2012)
m = c(0.16, 0.7, 0.8, 0.5, 1/83) # last point is asymptotic survival
s = 1 - m
D = c(1.0, 2.5, 5.0, 10.0, 2774/103.7795) # last point is asymptotic diameter
## Converting to biomass
B = diameter_to_biomass(D,a,b,rho)/1000
## Survival model
sigmoid = function(x, a, b, c) a/(1+exp(-(x - b)*c))
## Visualisation
par(mfrow=c(3,1), bty='l')
plot(B, D, type='b', xlab='Biomass (kg/tree)', ylab='Diameter (cm)')
plot(B, D * rho, type='b', xlab='Biomass (kg/tree)', ylab='Height (cm)')
plot(B, s, type='b', xlab='Biomass (kg/tree)', ylab='Survival Probability')
x = seq(0,max(B),0.1)
lines(x, sigmoid(x, 0.988, -75.0, 0.025), col='blue') # Without Canker disease
lines(x, sigmoid(x, 0.988, 20.0, 0.05), col='red') # With Canker disease
par(mfrow=c(1,1))
#
###
2774/103.7795
## Response and explanatory variable
Y = log(data$total.weight/data$density * 1.2)
X = data$age
## Quadratic interpolation
interpolation = lm(Y ~ X + I(X^2))
## Age-to-biomass model
age_to_biomass = function(A, bbeta=interpolation$coefficients) exp(bbeta[1] + bbeta[2] * A + bbeta[3] * A^2)
## Visualise
x = seq(0, 10, .1)
plot(data$age, data$total.weight/data$density * 1.2, xlim=c(0,10), ylim=c(0,1), xlab='Age (years)', ylab='Total Biomass (kg/tree)')
lines(x, age_to_biomass(x), col="red")
## Load data
data = read.csv('cole-2021-fig-6.csv', header=T, sep=',')
head(data)
## Format data
data$reproduction = data$reproduction/max(data$reproduction) * 0.75 # Scale by max reproduction (Worrell et al. 1999)
## Change colnames
colnames(data) = c('a','r')
## Visualise
par(mfrow=c(2,1))
plot(data$a, data$r, type='b', xlim=c(0,10), ylim=c(0,1))
plot(age_to_biomass(data$a), data$r, type='b', xlim=c(0,10), ylim=c(0,1))
par(mfrow=c(1,1))
## Visualise
par(mfrow=c(2,1))
plot(data$a, data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Age (years)', ylab='Survival Probability')
plot(age_to_biomass(data$a), data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Total Biomass (kg/tree)', ylab='Survival Probability')
par(mfrow=c(1,1))
## Define function
survival = function(z, a, b, c) a/(1+exp(-(z - b)*c))
## Define function
survival = function(x, a, b, c) a/(1+exp(-(x - b)*c))
## Visualise
par(mfrow=c(2,1))
plot(data$a, data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Age (years)', ylab='Survival Probability')
plot(age_to_biomass(data$a), data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Total Biomass (kg/tree)', ylab='Survival Probability')
x = seq(0,10,0.1)
lines(x, survival(x, 0.75, 0.7, 1.0), col='red')
par(mfrow=c(1,1))
## Visualise
par(mfrow=c(2,1))
plot(data$a, data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Age (years)', ylab='Survival Probability')
plot(age_to_biomass(data$a), data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Total Biomass (kg/tree)', ylab='Survival Probability')
x = seq(0,10,0.1)
lines(x, survival(x, 0.75, 0.7, 2.5), col='red')
par(mfrow=c(1,1))
## Visualise
par(mfrow=c(2,1))
plot(data$a, data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Age (years)', ylab='Survival Probability')
plot(age_to_biomass(data$a), data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Total Biomass (kg/tree)', ylab='Survival Probability')
x = seq(0,10,0.1)
lines(x, survival(x, 0.75, 0.7, 4.0), col='red')
par(mfrow=c(1,1))
## Visualise
par(mfrow=c(2,1))
plot(data$a, data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Age (years)', ylab='Survival Probability')
plot(age_to_biomass(data$a), data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Total Biomass (kg/tree)', ylab='Survival Probability')
x = seq(0,10,0.1)
lines(x, survival(x, 0.75, 0.5, 4.0), col='red')
par(mfrow=c(1,1))
## Visualise
par(mfrow=c(2,1))
plot(data$a, data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Age (years)', ylab='Survival Probability')
plot(age_to_biomass(data$a), data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Total Biomass (kg/tree)', ylab='Survival Probability')
x = seq(0,10,0.1)
lines(x, survival(x, 0.75, 0.5, 5.0), col='red')
par(mfrow=c(1,1))
## Visualise
par(mfrow=c(2,1))
plot(data$a, data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Age (years)', ylab='Survival Probability')
plot(age_to_biomass(data$a), data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Total Biomass (kg/tree)', ylab='Survival Probability')
x = seq(0,10,0.1)
lines(x, survival(x, 0.75, 0.5, 10.0), col='red')
par(mfrow=c(1,1))
###################################
## REPRODUCTION - ANALYSIS DATA  ##
###################################
## Load data
data = read.csv('cole-2021-fig-6.csv', header=T, sep=',')
head(data)
## Format data
data$reproduction = data$reproduction/max(data$reproduction) * 0.75 # Scale by max reproduction (Worrell et al. 1999)
## Change colnames
colnames(data) = c('a','r')
## Define function
reproduction = function(x, a, b, c) a/(1+exp(-(x - b)*c))
## Visualise
par(mfrow=c(2,1))
plot(data$a, data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Age (years)', ylab='Reproduction Probability')
plot(age_to_biomass(data$a), data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Total Biomass (kg/tree)', ylab='Reproduction Probability')
x = seq(0,10,0.1)
lines(x, reproduction(x, 0.75, 0.5, 10.0), col='red')
par(mfrow=c(1,1))
#
###
## Visualise
par(mfrow=c(2,1))
A = seq(0,10,0.1)
W = age_to_biomass(A)
#
plot(data$a, data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Age (years)', ylab='Reproduction Probability')
lines(A, reproduction(W, 0.75, 0.5, 10.0), col='red')
#
plot(age_to_biomass(data$a), data$r, type='b', xlim=c(0,10), ylim=c(0,1), xlab='Total Biomass (kg/tree)', ylab='Reproduction Probability')
lines(W, reproduction(W, 0.75, 0.5, 10.0), col='red')
#
par(mfrow=c(1,1))
print(age_to_biomass(0.5))
## Survival
# 0.3 kg at 6 years old ()
# In first year should be seedlings and experience high mortality
xx = seq(0, 1.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.983, 0.1, 10.0))
mean(yy(seq(0.0,2.0,0.1), 0.983, 0.1, 10.0))
###############
## LOAD DATA ##
###############
#
###
#######################
## HEIGHT TO BIOMASS ##
#######################
## Load data (Atchley 1989)
dat = read.csv('atchley-1989-table-8.csv', sep=',', header=T)
###############
## LOAD DATA ##
###############
#
###
#######################
## HEIGHT TO BIOMASS ##
#######################
## Load data (Atchley 1989)
dat = read.csv('atchley-1989-table-8.csv', sep=',', header=T)
setwd("~/Library/CloudStorage/GoogleDrive-willem.bonnaffe@gmail.com/My Drive/my-files/projects/yem/supporting-data-2025-04-18-willow")
###############
## LOAD DATA ##
###############
#
###
#######################
## HEIGHT TO BIOMASS ##
#######################
## Load data (Atchley 1989)
dat = read.csv('atchley-1989-table-8.csv', sep=',', header=T)
head(dat)
## Height to biomass (cm to grams) (Atchley 1989)
xx = dat$Height..cm.
yy = log(dat$Shoot.wt...g. + dat$Root.wt...g.)
plot(xx, exp(yy), bty='l', xlim=c(0,300), ylim=c(0,5000))
interpolation = lm(yy ~ xx)
height_to_biomass = function(x, params = interpolation$coefficient) exp(params[1] + params[2] * x)
lines(xx, height_to_biomass(xx), col='red')
print(height_to_biomass(300))
## Shoot to root
root_to_shoot_mean = mean(1/dat$Shoot.root)
root_to_shoot_sd = sd(1/dat$Shoot.root)
print(root_to_shoot_mean)
print(root_to_shoot_sd)
## Height to biomass (m to kg) (Mosseler et al. 2016)
xx = seq(0, 5, 0.1)
height_to_biomass = function(x) (-0.459 + 0.782 * x ) * 1.3 # Adding below-ground biomass
yy = height_to_biomass(xx)
plot(xx, yy, type='l', xlab='Height (m)', ylab='Biomass (kg)')
lines(xx, rep(0.3, length(xx)), lty=2)
lines(c(-1,1)*100, c(-1,1)*100, lty=3)
print(height_to_biomass(5.0))
#
###
##############
## SURVIVAL ##
##############
## Survival
# 0.3 kg at 6 years old ()
# In first year should be seedlings and experience high mortality
xx = seq(0, 5.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.983, 0.1, 5))
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
#
###
1.3 * 0.5
lines(c(0.65, 0.65),c(0, 1.0), lty=2)
## Survival
# 0.3 kg at 6 years old ()
# In first year should be seedlings and experience high mortality
xx = seq(0, 5.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.983, 0.1, 5), xlab='Biomass (kg)', 'Survival Rate (prop.)')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
###############
## LOAD DATA ##
###############
#
###
#######################
## HEIGHT TO BIOMASS ##
#######################
## Load data (Atchley 1989)
dat = read.csv('atchley-1989-table-8.csv', sep=',', header=T)
head(dat)
## Height to biomass (cm to grams) (Atchley 1989)
xx = dat$Height..cm.
yy = log(dat$Shoot.wt...g. + dat$Root.wt...g.)
plot(xx, exp(yy), bty='l', xlim=c(0,300), ylim=c(0,5000))
interpolation = lm(yy ~ xx)
height_to_biomass = function(x, params = interpolation$coefficient) exp(params[1] + params[2] * x)
lines(xx, height_to_biomass(xx), col='red')
print(height_to_biomass(300))
## Shoot to root
root_to_shoot_mean = mean(1/dat$Shoot.root)
root_to_shoot_sd = sd(1/dat$Shoot.root)
print(root_to_shoot_mean)
print(root_to_shoot_sd)
## Height to biomass (m to kg) (Mosseler et al. 2016)
xx = seq(0, 5, 0.1)
height_to_biomass = function(x) (-0.459 + 0.782 * x ) * 1.3 # Adding below-ground biomass
yy = height_to_biomass(xx)
plot(xx, yy, type='l', xlab='Height (m)', ylab='Biomass (kg)')
lines(xx, rep(0.3, length(xx)), lty=2)
lines(c(-1,1)*100, c(-1,1)*100, lty=3)
print(height_to_biomass(5.0))
#
###
##############
## SURVIVAL ##
##############
## Survival
# 0.3 kg at 6 years old ()
# In first year should be seedlings and experience high mortality
xx = seq(0, 5.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.983, 0.1, 5), xlab='Biomass (kg)', 'Survival Rate (prop.)')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
#
###
plot(xx,yy(xx, 0.983, 0.1, 5), xlab='Biomass (kg)', ylab='Survival Rate (prop.)')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
xx = seq(0, 5.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.983, 0.1, 5), xlab='Biomass (kg)', ylab='Survival Rate (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
## Load data (Atchley 1989)
dat = read.csv('atchley-1989-table-8.csv', sep=',', header=T)
head(dat)
## Height to biomass (cm to grams) (Atchley 1989)
xx = dat$Height..cm.
yy = log(dat$Shoot.wt...g. + dat$Root.wt...g.)
plot(xx, exp(yy), bty='l', xlim=c(0,300), ylim=c(0,5000))
interpolation = lm(yy ~ xx)
height_to_biomass = function(x, params = interpolation$coefficient) exp(params[1] + params[2] * x)
lines(xx, height_to_biomass(xx), col='red')
print(height_to_biomass(300))
## Shoot to root
root_to_shoot_mean = mean(1/dat$Shoot.root)
root_to_shoot_sd = sd(1/dat$Shoot.root)
print(root_to_shoot_mean)
print(root_to_shoot_sd)
## Height to biomass (m to kg) (Mosseler et al. 2016)
xx = seq(0, 5, 0.1)
height_to_biomass = function(x) (-0.459 + 0.782 * x ) * 1.3 # Adding below-ground biomass
yy = height_to_biomass(xx)
plot(xx, yy, type='l', xlab='Height (m)', ylab='Biomass (kg)')
lines(xx, rep(0.3, length(xx)), lty=2)
lines(c(-1,1)*100, c(-1,1)*100, lty=3)
print(height_to_biomass(5.0))
print(height_to_biomass(5.0))
##############
## SURVIVAL ##
##############
## Survival
# 0.3 kg at 2 years old ()
# In first year should be seedlings and experience high mortality
xx = seq(0, 5.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.983, 0.1, 5), xlab='Biomass (kg)', ylab='Survival Rate (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
#
###
## Survival
# 0.350 kg in first year
# In first year should be seedlings and experience high mortality
xx = seq(0, 5.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.983, 0.1, 5), xlab='Biomass (kg)', ylab='Survival Rate (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
xx = seq(0, 5.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.983, 0.1, 5), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
## Survival
# 0.350 kg in first year
# In first year should be seedlings and experience high mortality
xx = seq(0, 5.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.3, 0.1, 5), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
xx = seq(0, 5.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.3, 0.1, 5), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.2, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
## Survival
# 0.350 kg in first year
# In first year should be seedlings and experience high mortality
xx = seq(0, 5.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.3, 0.1, 5), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 10))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
xx = seq(0, 5.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.3, 0.1, 5), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 10))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
xx = seq(0, 5.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.3, 0.1, 10), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
xx = seq(0, 5.0, .01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 0.3, 0.2, 5), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
plot(xx,yy(xx, 0.3, 0.2, 7), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
plot(xx,yy(xx, 0.3, 0.3, 7), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
plot(xx,yy(xx, 0.4, 0.3, 10), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
print(height_to_biomass(5.0))
plot(xx,yy(xx, 0.4, 0.4, 10), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
plot(xx,yy(xx, 0.4, 1.0, 10), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
plot(xx,yy(xx, 0.4, 0.5, 10), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
plot(xx,yy(xx, 0.4, 0.75, 10), xlab='Biomass (kg)', ylab='Probability of reproduction (prop.)', type='l')
mean(yy(seq(0.0,5.0,0.1), 0.983, 0.1, 5))
lines(c(0.65, 0.65), c(0, 1.0), lty=2)
#######################
## HEIGHT TO BIOMASS ##
#######################
## Load data (Atchley 1989)
dat = read.csv('atchley-1989-table-8.csv', sep=',', header=T)
head(dat)
## Height to biomass (cm to grams) (Atchley 1989)
xx = dat$Height..cm.
yy = log(dat$Shoot.wt...g. + dat$Root.wt...g.)
plot(xx, exp(yy), bty='l', xlim=c(0,300), ylim=c(0,5000))
interpolation = lm(yy ~ xx)
height_to_biomass = function(x, params = interpolation$coefficient) exp(params[1] + params[2] * x)
lines(xx, height_to_biomass(xx), col='red')
print(height_to_biomass(300))
## Shoot to root
root_to_shoot_mean = mean(1/dat$Shoot.root)
root_to_shoot_sd = sd(1/dat$Shoot.root)
print(root_to_shoot_mean)
print(root_to_shoot_sd)
## Height to biomass (m to kg) (Mosseler et al. 2016)
xx = seq(0, 5, 0.1)
height_to_biomass = function(x) (-0.459 + 0.782 * x ) * 1.3 # Adding below-ground biomass
yy = height_to_biomass(xx)
plot(xx, yy, type='l', xlab='Height (m)', ylab='Biomass (kg)')
lines(xx, rep(0.3, length(xx)), lty=2)
lines(c(-1,1)*100, c(-1,1)*100, lty=3)
print(height_to_biomass(5.0))
#
###
print(height_to_biomass(5.0))
print(height_to_biomass(3.0))
xx = seq(0, 5.0, 0.01)
yy = function(x, a, b, c) a/(1+exp(-(x-b)*c))
plot(xx,yy(xx, 1.0, 2.5, -10.0), xlab='Biomass (kg)', ylab='Probability of browsing (prop.)', type='l')
plot(xx,yy(xx, 1.0, 2.0, -10.0), xlab='Biomass (kg)', ylab='Probability of browsing (prop.)', type='l')
